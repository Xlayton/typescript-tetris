!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Point=void 0;e.Point=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n}},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=void 0;var o=n(0),s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rotation=0}return i(t,[{key:"move",value:function(t,e){var n=[],i=!0,s=!1,r=void 0;try{for(var a,h=this.points[Symbol.iterator]();!(i=(a=h.next()).done);i=!0){var u=a.value;n.push(new o.Point(u.x+t,u.y+e))}}catch(t){s=!0,r=t}finally{try{!i&&h.return&&h.return()}finally{if(s)throw r}}return n}},{key:"setPos",value:function(t){this.points=t}},{key:"drop",value:function(){return this.move(0,1)}},{key:"moveLeft",value:function(){return this.move(-1,0)}},{key:"moveRight",value:function(){return this.move(1,0)}},{key:"rotate",value:function(t){throw new Error("This method is abstract")}}]),t}();e.Shape=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.requestAnimFrame=void 0;var i=n(3);e.requestAnimFrame=window.requestAnimationFrame||window.requestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},window.addEventListener("DOMContentLoaded",(function(){new i.Game}),!1)},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var o=n(4),s=n(2),r=n(5),a=n(6),h=n(7),u=n(8),p=n(9),l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.running=!1,this.phase=t.gameState.initial,this.scoreLabel=document.getElementById("scoreLabel"),this.rowsLabel=document.getElementById("rowsLabel"),this.levelLabel=document.getElementById("levelLabel"),this.messageLabel=document.getElementById("floatingMessage"),this.canvas=document.getElementById("gameCanvas"),this.context=this.canvas.getContext("2d"),this.grid=new o.Grid(16,10,20,"gray",this.canvas),this.grid.eraseGrid(),this.speed=1e3;var e=this;document.onkeydown=function(t){e.keyhandler(t)},this.showMessage("Press F2 to start")}return i(t,[{key:"draw",value:function(){var e;this.phase==t.gameState.playing&&(this.grid.paint(),this.grid.draw(this.currentShape),s.requestAnimFrame((e=this,function(){e.draw()})))}},{key:"newGame",value:function(){var e;this.messageLabel.style.display="none",this.grid.clearGrid(),this.currentShape=this.newShape(),this.score=0,this.rowsCompleted=0,this.score=0,this.level=-1,this.speed=1e3,this.phase=t.gameState.playing,s.requestAnimFrame((e=this,function(){e.draw()})),this.incrementLevel()}},{key:"updateLabels",value:function(){this.scoreLabel.innerText=this.score.toString(),this.rowsLabel.innerText=this.rowsCompleted.toString(),this.levelLabel.innerText=this.level.toString()}},{key:"gameTimer",value:function(){if(this.phase==t.gameState.playing){var e=this.currentShape.drop();this.grid.isPosValid(e)?this.currentShape.setPos(e):this.shapeFinished()}}},{key:"keyhandler",value:function(e){var n=void 0;if(this.phase==t.gameState.playing){switch(e.keyCode){case 39:n=this.currentShape.moveRight();break;case 37:n=this.currentShape.moveLeft();break;case 38:n=this.currentShape.rotate(!0);break;case 40:for(n=this.currentShape.drop();this.grid.isPosValid(n);)this.currentShape.setPos(n),n=this.currentShape.drop();this.shapeFinished()}switch(e.keyCode){case 39:case 37:case 38:this.grid.isPosValid(n)&&this.currentShape.setPos(n)}}113==e.keyCode?this.newGame():80==e.keyCode?this.togglePause():70==e.keyCode&&(this.level<10&&this.phase==t.gameState.playing||this.phase==t.gameState.paused)&&this.incrementLevel()}},{key:"togglePause",value:function(){this.phase==t.gameState.paused?(this.messageLabel.style.display="none",this.phase=t.gameState.playing,this.draw()):this.phase==t.gameState.playing&&(this.phase=t.gameState.paused,this.showMessage("PAUSED"))}},{key:"showMessage",value:function(t){this.messageLabel.style.display="block",this.messageLabel.innerText=t}},{key:"incrementLevel",value:function(){var t;this.level++,this.level<10&&(this.speed=1e3-100*this.level,clearTimeout(this.timerToken),this.timerToken=setInterval((t=this,function(){t.gameTimer()}),this.speed)),this.updateLabels()}},{key:"shapeFinished",value:function(){if(this.grid.addShape(this.currentShape)){this.grid.draw(this.currentShape);var e=this.grid.checkRows(this.currentShape);this.rowsCompleted+=e,this.score+=e*(this.level+1)*10,this.rowsCompleted>10*(this.level+1)&&this.incrementLevel(),this.updateLabels(),this.currentShape=this.newShape()}else window.console&&console.log("Game over"),this.phase=t.gameState.gameover,this.showMessage("GAME OVER\nPress F2 to Start"),clearTimeout(this.timerToken)}},{key:"newShape",value:function(){var t=void 0;switch(Math.floor(7*Math.random())){case 0:t=new a.LShape(!1,this.grid.cols);break;case 1:t=new a.LShape(!0,this.grid.cols);break;case 2:t=new p.TShape(this.grid.cols);break;case 3:t=new u.StepShape(!1,this.grid.cols);break;case 4:t=new u.StepShape(!0,this.grid.cols);break;case 5:t=new h.SquareShape(this.grid.cols);break;case 6:t=new r.StraightShape(this.grid.cols)}return t}}]),t}();e.Game=l,l.gameState={initial:0,playing:1,paused:2,gameover:3}},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Grid=void 0;var o=n(0),s=function(){function t(e,n,i,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=s,this.context=s.getContext("2d"),this.blockSize=i,this.blockColor=new Array(e),this.backColor=o,this.cols=n,this.rows=e;for(var r=0;r<e;r++)this.blockColor[r]=new Array(n);this.xOffset=20,this.yOffset=20}return i(t,[{key:"draw",value:function(t){this.paintShape(t,t.fillColor)}},{key:"erase",value:function(t){this.paintShape(t,this.backColor)}},{key:"paintShape",value:function(t,e){var n=this;t.points.forEach((function(t){return n.paintSquare(t.y,t.x,e)}))}},{key:"getPreferredSize",value:function(){return new o.Point(this.blockSize*this.cols,this.blockSize*this.rows)}},{key:"isPosValid",value:function(t){var e=!0,n=!0,i=!1,o=void 0;try{for(var s,r=t[Symbol.iterator]();!(n=(s=r.next()).done);n=!0){var a=s.value;if(a.x<0||a.x>=this.cols||a.y>=this.rows){e=!1;break}if(a.y>=0&&this.blockColor[a.y][a.x]!==this.backColor){e=!1;break}}}catch(t){i=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}return e}},{key:"addShape",value:function(t){var e=!0,n=!1,i=void 0;try{for(var o,s=t.points[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var r=o.value;if(r.y<0)return!1;this.blockColor[r.y][r.x]=t.fillColor}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}return!0}},{key:"eraseGrid",value:function(){this.context.fillStyle=this.backColor;var t=this.cols*this.blockSize,e=this.rows*this.blockSize;this.context.fillRect(this.xOffset,this.yOffset,t,e)}},{key:"clearGrid",value:function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.cols;e++)this.blockColor[t][e]=this.backColor;this.eraseGrid()}},{key:"paintSquare",value:function(t,e,n){t>=0&&(this.context.fillStyle=n,this.context.fillRect(this.xOffset+e*this.blockSize,this.yOffset+t*this.blockSize,this.blockSize-1,this.blockSize-1))}},{key:"drawGrid",value:function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.cols;e++)this.blockColor[t][e]!==this.backColor&&this.paintSquare(t,e,this.blockColor[t][e])}},{key:"paint",value:function(){this.eraseGrid(),this.drawGrid()}},{key:"checkRows",value:function(t){for(var e=t.points[0].y,n=t.points[0].y,i=void 0,o=0,s=1;s<t.points.length;s++)t.points[s].y<e&&(e=t.points[s].y),t.points[s].y>n&&(n=t.points[s].y);for(e<0&&(e=0);n>=e;){i=!0;for(var r=0;r<this.cols;r++)if(this.blockColor[n][r]===this.backColor){i=!1;break}if(i){o++;for(var a=n;a>=0;a--)for(var h=0;h<this.cols;h++)this.blockColor[a][h]=a>0?this.blockColor[a-1][h]:this.backColor;e++}else n--}return o>0&&(this.eraseGrid(),this.paint()),o}}]),t}();e.Grid=s},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StraightShape=void 0;var o=n(0),s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));n.fillColor="blue";var i=t/2;return n.points=[],n.points.push(new o.Point(i,-4)),n.points.push(new o.Point(i,-3)),n.points.push(new o.Point(i,-2)),n.points.push(new o.Point(i,-1)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"rotate",value:function(t){this.rotation=(this.rotation+(t?1:-1))%2;var e=[];switch(this.rotation){case 0:e[0]=new o.Point(this.points[2].x,this.points[2].y-2),e[1]=new o.Point(this.points[2].x,this.points[2].y-1),e[2]=new o.Point(this.points[2].x,this.points[2].y),e[3]=new o.Point(this.points[2].x,this.points[2].y+1);break;case 1:e[0]=new o.Point(this.points[2].x+2,this.points[2].y),e[1]=new o.Point(this.points[2].x+1,this.points[2].y),e[2]=new o.Point(this.points[2].x,this.points[2].y),e[3]=new o.Point(this.points[2].x-1,this.points[2].y)}return e}}]),e}(n(1).Shape);e.StraightShape=s},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.LShape=void 0;var o=n(0),s=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));i.leftHanded=t,i.fillColor=t?"yellow":"white";var s=n/2;return i.points=[],i.points.push(new o.Point(s,-3)),i.points.push(new o.Point(s,-2)),i.points.push(new o.Point(s,-1)),i.points.push(new o.Point(s+(t?-1:1),-1)),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"rotate",value:function(t){this.rotation=(this.rotation+(t?1:-1))%4;var e=[];switch(this.rotation){case 0:e.push(new o.Point(this.points[1].x,this.points[1].y-1)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y+1)),e.push(new o.Point(this.points[1].x+(this.leftHanded?-1:1),this.points[1].y+1));break;case 1:e.push(new o.Point(this.points[1].x+1,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x-1,this.points[1].y)),e.push(new o.Point(this.points[1].x-1,this.points[1].y+(this.leftHanded?-1:1)));break;case 2:e.push(new o.Point(this.points[1].x,this.points[1].y+1)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y-1)),e.push(new o.Point(this.points[1].x+(this.leftHanded?1:-1),this.points[1].y-1));break;case 3:e.push(new o.Point(this.points[1].x-1,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x+1,this.points[1].y)),e.push(new o.Point(this.points[1].x+1,this.points[1].y+(this.leftHanded?1:-1)))}return e}}]),e}(n(1).Shape);e.LShape=s},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SquareShape=void 0;var o=n(0),s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));n.fillColor="green";var i=t/2;return n.points=[],n.points.push(new o.Point(i,-2)),n.points.push(new o.Point(i+1,-2)),n.points.push(new o.Point(i,-1)),n.points.push(new o.Point(i+1,-1)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"rotate",value:function(t){return this.points}}]),e}(n(1).Shape);e.SquareShape=s},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StepShape=void 0;var o=n(0),s=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));i.fillColor=t?"cyan":"magenta",i.leftHanded=t;var s=n/2;return i.points=[],i.points.push(new o.Point(s+(t?1:-1),-1)),i.points.push(new o.Point(s,-1)),i.points.push(new o.Point(s,-2)),i.points.push(new o.Point(s+(t?-1:1),-2)),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"rotate",value:function(t){this.rotation=(this.rotation+(t?1:-1))%2;var e=[];switch(this.rotation){case 0:e.push(new o.Point(this.points[1].x+(this.leftHanded?1:-1),this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y-1)),e.push(new o.Point(this.points[1].x+(this.leftHanded?-1:1),this.points[1].y-1));break;case 1:e.push(new o.Point(this.points[1].x,this.points[1].y+(this.leftHanded?1:-1))),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x+1,this.points[1].y)),e.push(new o.Point(this.points[1].x+1,this.points[1].y+(this.leftHanded?-1:1)))}return e}}]),e}(n(1).Shape);e.StepShape=s},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TShape=void 0;var o=n(0),s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));n.fillColor="red",n.points=[];var i=t/2;return n.points.push(new o.Point(i-1,-2)),n.points.push(new o.Point(i,-2)),n.points.push(new o.Point(i+1,-2)),n.points.push(new o.Point(i,-1)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"rotate",value:function(t){this.rotation=(this.rotation+(t?1:-1))%4;var e=[];switch(this.rotation){case 0:e.push(new o.Point(this.points[1].x-1,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x+1,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y+1));break;case 1:e.push(new o.Point(this.points[1].x,this.points[1].y-1)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y+1)),e.push(new o.Point(this.points[1].x-1,this.points[1].y));break;case 2:e.push(new o.Point(this.points[1].x+1,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x-1,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y-1));break;case 3:e.push(new o.Point(this.points[1].x,this.points[1].y+1)),e.push(new o.Point(this.points[1].x,this.points[1].y)),e.push(new o.Point(this.points[1].x,this.points[1].y-1)),e.push(new o.Point(this.points[1].x+1,this.points[1].y))}return e}}]),e}(n(1).Shape);e.TShape=s}]);
//# sourceMappingURL=app.js.map